<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Automatic Provisioning of AWS IAM Identity Center Users and Groups from Google Workspace Directory using SSO Sync" /><meta property="og:locale" content="en" /><meta name="description" content="Introduction" /><meta property="og:description" content="Introduction" /><link rel="canonical" href="https://nathaniel.varona.me/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/" /><meta property="og:url" content="https://nathaniel.varona.me/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/" /><meta property="og:site_name" content="Nathaniel Varona" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-02-11T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Automatic Provisioning of AWS IAM Identity Center Users and Groups from Google Workspace Directory using SSO Sync" /><meta name="twitter:site" content="@nathanielvarona" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-08-28T12:32:23+08:00","datePublished":"2023-02-11T00:00:00+08:00","description":"Introduction","headline":"Automatic Provisioning of AWS IAM Identity Center Users and Groups from Google Workspace Directory using SSO Sync","mainEntityOfPage":{"@type":"WebPage","@id":"https://nathaniel.varona.me/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/"},"url":"https://nathaniel.varona.me/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/"}</script><title>Automatic Provisioning of AWS IAM Identity Center Users and Groups from Google Workspace Directory using SSO Sync | Nathaniel Varona</title><link rel="icon" type="image/png" href="/assets/img/favicons/favicon-96x96.png" sizes="96x96"><link rel="icon" type="image/svg+xml" href="/assets/img/favicons/favicon.svg"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.36.4/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.18/dayjs.min.js,npm/dayjs@1.11.18/locale/en.js,npm/dayjs@1.11.18/plugin/relativeTime.js,npm/dayjs@1.11.18/plugin/localizedFormat.js,npm/tocbot@4.36.4/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-7S51SBJX8F"></script> <script> document.addEventListener('DOMContentLoaded', () => { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-7S51SBJX8F'); }); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/favicons/android-chrome-512x512.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">Nathaniel Varona</a><p class="site-subtitle fst-italic mb-0">I am a DevOps and SRE focussing on Cloud Computing and Distributed Systems.</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav">
<li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a>
</li>
<li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a>
</li>
<li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a>
</li>
<li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a>
</li>
<li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a>
</li>
</ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/nathanielvarona" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/nathanielvarona" aria-label="twitter" target="_blank" rel="noopener noreferrer"> <i class="fab fa-x-twitter"></i> </a> <a href="https://www.linkedin.com/in/nathanielvarona" aria-label="linkedin" target="_blank" rel="noopener noreferrer"> <i class="fab fa-linkedin"></i> </a>
</div></aside><div id="main-wrapper" class="d-flex justify-content-center">
<div class="container d-flex flex-column px-xxl-5">
<header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100">
<nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Automatic Provisioning of AWS IAM Identity Center Users and Groups from Google Workspace Directory using SSO Sync</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div>
<button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
</div></header><div class="row flex-grow-1">
<main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>Automatic Provisioning of AWS IAM Identity Center Users and Groups from Google Workspace Directory using SSO Sync</h1>
<div class="post-meta text-muted"> <span> Posted <time data-ts="1676044800" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom"> Feb 11, 2023 </time> </span> <span> Updated <time data-ts="1724819543" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom"> Aug 28, 2024 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/nathanielvarona">Nathaniel Varona</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="2226 words"> <em>12 min</em> read</span>
</div>
</div>
</div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">Automatic Provisioning of AWS IAM Identity Center Users and Groups from Google Workspace Directory using SSO Sync</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button>
</div>
<button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between">
<div class="label text-truncate py-2 ms-4">Automatic Provisioning of AWS IAM Identity Center Users and Groups from Google Workspace Directory using SSO Sync</div>
<button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button>
</div>
<div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content">
<h2 id="introduction">
<span class="me-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h2>
<p>AWS IAM Identity Center supports automatic provisioning from various providers, including OneLogin, Microsoft Azure Active Directory, on-premise MS Active Directory, and other supported identity providers via the System for Cross-domain Identity Management (SCIM) implementation.</p>
<p>Google Workspace custom Security Assertion Markup Language (SAML) applications, on the other hand, donâ€™t support automatic provisioning yet. On the other hand, AWS and Google are working with Fast Federation (FastFed) Working Group to make this feature available.</p>
<p>In the meantime, to automate the process of synchronizing users and groups from the Google Workspace Directory to the AWS IAM Identity Center, we will use the SSOSYNC project provided by AWSLABS.</p>
<p>In this post, we will walk you through the process of how the synchronization works and set up of SSOSYNC, running it locally for testing/debugging and deploying it as a serverless application.</p>
<h2 id="identity-synchronization-diagram">
<span class="me-2">Identity Synchronization Diagram</span><a href="#identity-synchronization-diagram" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h2>
<p><a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/identity-synchronization-diagram-dark.png" class="popup img-link dark shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/identity-synchronization-diagram-dark.png" alt="Identity Synchronization Diagram" loading="lazy"></a> <a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/identity-synchronization-diagram-light.png" class="popup img-link light shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/identity-synchronization-diagram-light.png" alt="Identity Synchronization Diagram" loading="lazy"></a></p>
<blockquote><p><em>Created with <a href="https://mermaid.js.org/intro/" target="_blank">mermaid.js</a></em></p></blockquote>
<h2 id="google-gcp-google-workspace-and-aws-iam-ic-setup">
<span class="me-2">Google GCP, Google Workspace, and AWS IAM IC Setup</span><a href="#google-gcp-google-workspace-and-aws-iam-ic-setup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h2>
<p>We will set up the Google GCP Service Account, Google Workspace for Domain wide delegation, and AWS IAM Identity Center SCIM Credentials as required settings and parameters for our SSO Sync.</p>
<h3 id="google-gcp">
<span class="me-2">Google GCP</span><a href="#google-gcp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h3>
<p>First create an isolated GCP project only for AWS IAM Identity Center purpose. Then create or Enable the API Services for Admin SDK API.</p>
<h4 id="create-a-project">
<span class="me-2">Create a Project</span><a href="#create-a-project" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<p><a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-create-project-dark.png" class="popup img-link dark shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-create-project-dark.png" alt="Create a Project" loading="lazy"></a> <a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-create-project-light.png" class="popup img-link light shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-create-project-light.png" alt="Create a Project" loading="lazy"></a></p>
<h4 id="enable-api-and-services">
<span class="me-2">Enable API and Services</span><a href="#enable-api-and-services" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<p><a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-enable-api-and-services-dark.png" class="popup img-link dark shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-enable-api-and-services-dark.png" alt="Enable API and Services" loading="lazy"></a> <a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-enable-api-and-services-light.png" class="popup img-link light shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-enable-api-and-services-light.png" alt="Enable API and Services" loading="lazy"></a></p>
<h4 id="admin-sdk-api">
<span class="me-2">Admin SDK API</span><a href="#admin-sdk-api" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<p><a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-admin-sdk-api-dark.png" class="popup img-link dark shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-admin-sdk-api-dark.png" alt="Admin SDK API" loading="lazy"></a> <a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-admin-sdk-api-light.png" class="popup img-link light shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-admin-sdk-api-light.png" alt="Admin SDK API" loading="lazy"></a></p>
<h4 id="enable-admin-sdk-api">
<span class="me-2">Enable Admin SDK API</span><a href="#enable-admin-sdk-api" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<p><a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-enable-admin-sdk-api-dark.png" class="popup img-link dark shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-enable-admin-sdk-api-dark.png" alt="Enable Admin SDK API" loading="lazy"></a> <a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-enable-admin-sdk-api-light.png" class="popup img-link light shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-enable-admin-sdk-api-light.png" alt="Enable Admin SDK API" loading="lazy"></a></p>
<h3 id="service-account-and-client-id">
<span class="me-2">Service Account and Client ID</span><a href="#service-account-and-client-id" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h3>
<p>Create a Service Account this serves as our credentials to access the Google Workspace Directory resources.</p>
<h4 id="select-service-account-credential">
<span class="me-2">Select Service Account Credential</span><a href="#select-service-account-credential" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<p><a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-create-credentials-service-account-init-dark.png" class="popup img-link dark shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-create-credentials-service-account-init-dark.png" alt="Service Account Credential" loading="lazy"></a> <a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-create-credentials-service-account-init-light.png" class="popup img-link light shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-create-credentials-service-account-init-light.png" alt="Service Account Credential" loading="lazy"></a></p>
<h4 id="provide-service-account-credential-details">
<span class="me-2">Provide Service Account Credential Details</span><a href="#provide-service-account-credential-details" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<p><a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-create-credentials-service-account-details-dark.png" class="popup img-link dark shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-create-credentials-service-account-details-dark.png" alt="Service Account Credential Details" loading="lazy"></a> <a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-create-credentials-service-account-details-light.png" class="popup img-link light shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-create-credentials-service-account-details-light.png" alt="Service Account Credential Details" loading="lazy"></a></p>
<h4 id="select-service-account-create-new-key">
<span class="me-2">Select Service Account Create New Key</span><a href="#select-service-account-create-new-key" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<p><a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-credentials-service-account-add-keys-dark.png" class="popup img-link dark shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-credentials-service-account-add-keys-dark.png" alt="Service Account Create New Key" loading="lazy"></a> <a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-credentials-service-account-add-keys-light.png" class="popup img-link light shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-credentials-service-account-add-keys-light.png" alt="Service Account Create New Key" loading="lazy"></a></p>
<h4 id="service-account-create-json-type-private-key">
<span class="me-2">Service Account Create JSON Type Private Key</span><a href="#service-account-create-json-type-private-key" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<blockquote class="prompt-warning"><p>A <code class="language-plaintext highlighter-rouge">JSON</code> file will automatically be downloaded by the browser with a filename format named <code class="language-plaintext highlighter-rouge">aws-iam-identity-center-xxxxxx-xxxxxxxxxxxx.json</code>. Save it in a safe place for our <code class="language-plaintext highlighter-rouge">SSO Sync</code> CLI tool and for serverless application to log into Google.</p></blockquote>
<p><a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-credentials-service-account-download-key-json-dark.png" class="popup img-link dark shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-credentials-service-account-download-key-json-dark.png" alt="Service Account Create JSON Type Private Key" loading="lazy"></a> <a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-credentials-service-account-download-key-json-light.png" class="popup img-link light shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-credentials-service-account-download-key-json-light.png" alt="Service Account Create JSON Type Private Key" loading="lazy"></a></p>
<blockquote class="prompt-tip"><p>To identify and used it easily, just rename the file <code class="language-plaintext highlighter-rouge">aws-iam-identity-center-xxxxxx-xxxxxxxxxxxx.json</code> to <code class="language-plaintext highlighter-rouge">credentials.json</code></p></blockquote>
<div class="language-bash nolineno highlighter-rouge" file="Rename Google Service Account Credentials">
<div class="code-header"> <span data-label-text="Rename Google Service Account Credentials"><i class="far fa-file-code fa-fw"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td>
<td class="rouge-code"><pre><span class="nb">mv </span>aws-iam-identity-center-xxxxxx-xxxxxxxxxxxx.json credentials.json
</pre></td>
</tr></tbody></table></code></div>
</div>
<h4 id="service-account-credential-client-id">
<span class="me-2">Service Account Credential Client ID</span><a href="#service-account-credential-client-id" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<p>Copy the <code class="language-plaintext highlighter-rouge">21 digit</code> <code class="language-plaintext highlighter-rouge">Unique ID</code> this will be our <code class="language-plaintext highlighter-rouge">Client ID</code> for Google Workspace Domain Wide Delegation</p>
<p><a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-created-credentials-service-account-client-id-dark.png" class="popup img-link dark shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-created-credentials-service-account-client-id-dark.png" alt="Service Account Credential Client ID" loading="lazy"></a> <a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-created-credentials-service-account-client-id-light.png" class="popup img-link light shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/gcp-created-credentials-service-account-client-id-light.png" alt="Service Account Credential Client ID" loading="lazy"></a></p>
<h3 id="google-workspace-domain-wide-delegation">
<span class="me-2">Google Workspace Domain Wide Delegation</span><a href="#google-workspace-domain-wide-delegation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h3>
<p>Domain wide delegation settings provides a linkage from our service account to access the Google Workspace Directory based on the scopes we set, for what only the SSO Sync able to obtain.</p>
<h4 id="manage-domain-wide-delegation">
<span class="me-2">Manage Domain Wide Delegation</span><a href="#manage-domain-wide-delegation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<p><a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/google-workspace-api-control-domain-wide-delegation-dark.png" class="popup img-link dark shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/google-workspace-api-control-domain-wide-delegation-dark.png" alt="Manage Domain wide delegation" loading="lazy"></a> <a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/google-workspace-api-control-domain-wide-delegation-light.png" class="popup img-link light shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/google-workspace-api-control-domain-wide-delegation-light.png" alt="Manage Domain wide delegation" loading="lazy"></a></p>
<h4 id="domain-wide-delegation-add-client">
<span class="me-2">Domain Wide Delegation Add Client</span><a href="#domain-wide-delegation-add-client" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<p>Add the <code class="language-plaintext highlighter-rouge">Client ID</code> we copied from the <code class="language-plaintext highlighter-rouge">Service Account</code> details form <code class="language-plaintext filepath highlighter-rouge">IAM and Admin (GCP)</code> and add the list of <code class="language-plaintext highlighter-rouge">OAuth Scopes</code>.</p>
<div class="language-text nolineno highlighter-rouge" file="OAuth Scopes">
<div class="code-header"> <span data-label-text="OAuth Scopes"><i class="far fa-file-code fa-fw"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td>
<td class="rouge-code"><pre>https://www.googleapis.com/auth/admin.directory.group.readonly
https://www.googleapis.com/auth/admin.directory.group.member.readonly
https://www.googleapis.com/auth/admin.directory.user.readonly
</pre></td>
</tr></tbody></table></code></div>
</div>
<p><a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/google-workspace-api-control-domain-wide-delegation-add-client-dark.png" class="popup img-link dark shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/google-workspace-api-control-domain-wide-delegation-add-client-dark.png" alt="Domain wide delegation Add Client" loading="lazy"></a> <a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/google-workspace-api-control-domain-wide-delegation-add-client-light.png" class="popup img-link light shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/google-workspace-api-control-domain-wide-delegation-add-client-light.png" alt="Domain wide delegation Add Client" loading="lazy"></a></p>
<h3 id="aws-iam-identity-center-automatic-provisioning">
<span class="me-2">AWS IAM Identity Center Automatic provisioning</span><a href="#aws-iam-identity-center-automatic-provisioning" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h3>
<p>On AWS IAM Identity Center enable the automatic provisioning to complete the coordination from Google Workspace Directory</p>
<blockquote class="prompt-tip"><p>Please take note of the SCIM credentials right after we enable them.</p></blockquote>
<h4 id="enable-automatic-provisioning">
<span class="me-2">Enable Automatic provisioning</span><a href="#enable-automatic-provisioning" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<p><a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/aws-iam-ic-automatic-provisioning-dark.png" class="popup img-link dark shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/aws-iam-ic-automatic-provisioning-dark.png" alt="Enable Automatic provisioning" loading="lazy"></a> <a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/aws-iam-ic-automatic-provisioning-light.png" class="popup img-link light shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/aws-iam-ic-automatic-provisioning-light.png" alt="Enable Automatic provisioning" loading="lazy"></a></p>
<h4 id="automatic-provisioning-scim-configuration">
<span class="me-2">Automatic provisioning SCIM Configuration</span><a href="#automatic-provisioning-scim-configuration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<blockquote class="prompt-tip"><p>Copy the details from the <code class="language-plaintext highlighter-rouge">SCIM endpoint</code> to the <code class="language-plaintext highlighter-rouge">SSOSYNC_SCIM_ENDPOINT.txt</code> file and the <code class="language-plaintext highlighter-rouge">Access token</code> to the <code class="language-plaintext highlighter-rouge">SSOSYNC_SCIM_ACCESS_TOKEN.txt</code> file.</p></blockquote>
<blockquote class="prompt-warning"><p>Save these in a safe place for our <code class="language-plaintext highlighter-rouge">SSO Sync</code> CLI tool and for serverless application.</p></blockquote>
<p><a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/aws-iam-ic-automatic-provisioning-scim-dark.png" class="popup img-link dark shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/aws-iam-ic-automatic-provisioning-scim-dark.png" alt="Automatic provisioning SCIM Configuration" loading="lazy"></a> <a href="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/aws-iam-ic-automatic-provisioning-scim-light.png" class="popup img-link light shimmer"><img src="/assets/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/aws-iam-ic-automatic-provisioning-scim-light.png" alt="Automatic provisioning SCIM Configuration" loading="lazy"></a></p>
<h2 id="setup-the-sso-sync-from-aws-labs">
<span class="me-2">Setup the SSO Sync (from AWS Labs)</span><a href="#setup-the-sso-sync-from-aws-labs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h2>
<h3 id="clone-and-build-the-sso-sync-from-the-source-repository">
<span class="me-2">Clone and Build the SSO Sync from the Source Repository</span><a href="#clone-and-build-the-sso-sync-from-the-source-repository" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h3>
<p>AWS Labs provided the tool to complete the process, and it serves as a pipeline for users and groups from Google Workspace Directory to AWS IAM Identity Center. The project source requires building, and a compiled distributed binary is created.</p>
<h4 id="clone-sso-sync-repository">
<span class="me-2">Clone SSO Sync Repository</span><a href="#clone-sso-sync-repository" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<p>Copy the source from the AWS Github repository.</p>
<div class="language-bash nolineno highlighter-rouge" file="Clone SSO Sync Repository">
<div class="code-header"> <span data-label-text="Clone SSO Sync Repository"><i class="far fa-file-code fa-fw"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td>
<td class="rouge-code"><pre>git clone https://github.com/awslabs/ssosync.git
<span class="nb">cd </span>ssosync
code <span class="nb">.</span>
</pre></td>
</tr></tbody></table></code></div>
</div>
<h4 id="build-the-sso-sync">
<span class="me-2">Build the SSO Sync</span><a href="#build-the-sso-sync" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<p>Make sure you have the <a href="https://go.dev/doc/install">GO</a> installed in your system.</p>
<p>If you are on macOS and want to test the applications, use this command line option to build the specific binary for macOS</p>
<div class="language-bash nolineno highlighter-rouge" file="Build SSO Sync - Darwin/macOS">
<div class="code-header"> <span data-label-text="Build SSO Sync - Darwin/macOS"><i class="far fa-file-code fa-fw"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td>
<td class="rouge-code"><pre><span class="nv">GOOS</span><span class="o">=</span>darwin <span class="nv">GOARCH</span><span class="o">=</span>amd64 make go-build
<span class="nv">GOOS</span><span class="o">=</span>darwin <span class="nv">GOARCH</span><span class="o">=</span>arm64 make go-build
</pre></td>
</tr></tbody></table></code></div>
</div>
<p>For Linux and serverless applications, use this command line option.</p>
<div class="language-bash nolineno highlighter-rouge" file="Build SSO Sync - Linux">
<div class="code-header"> <span data-label-text="Build SSO Sync - Linux"><i class="far fa-file-code fa-fw"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td>
<td class="rouge-code"><pre><span class="nv">GOOS</span><span class="o">=</span>linux <span class="nv">GOARCH</span><span class="o">=</span>amd64 make go-build
</pre></td>
</tr></tbody></table></code></div>
</div>
<blockquote class="prompt-info"><p>Once a build is successfully run, a binary file <code class="language-plaintext filepath highlighter-rouge">./ssosync</code> is created.</p></blockquote>
<h3 id="manually-sync-through-cli-testing-or-debugging">
<span class="me-2">Manually Sync through CLI <em>(Testing or Debugging)</em></span><a href="#manually-sync-through-cli-testing-or-debugging" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h3>
<p>Using environment variables, we have provided the least required parameter for our SSO Sync.</p>
<blockquote class="prompt-tip"><ul>
<li>
<code class="language-plaintext filepath highlighter-rouge">credentials.json</code> is a file from the <a href="#service-account-create-json-type-private-key">Service Account Create JSON Type Private Key</a>.</li>
<li>
<code class="language-plaintext filepath highlighter-rouge">SSOSYNC_SCIM_ENDPOINT.txt</code> and <code class="language-plaintext filepath highlighter-rouge">SSOSYNC_SCIM_ACCESS_TOKEN.txt</code> are files from the <a href="#automatic-provisioning-scim-configuration">Automatic provisioning SCIM Configuration</a>.</li>
<li>
<code class="language-plaintext filepath highlighter-rouge">d-xxxxxxxxxx</code> is the <code class="language-plaintext filepath highlighter-rouge">Identity store ID</code> found in <a href="https://console.aws.amazon.com/singlesignon/">AWS Console &gt; IAM Identity Center</a> <code class="language-plaintext filepath highlighter-rouge">&gt; Settings &gt; Identity source</code>.</li>
</ul></blockquote>
<div class="language-bash nolineno highlighter-rouge" file=".env">
<div class="code-header"> <span data-label-text=".env"><i class="far fa-file-code fa-fw"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td>
<td class="rouge-code"><pre><span class="nv">SSOSYNC_LOG_LEVEL</span><span class="o">=</span>debug
<span class="nv">SSOSYNC_LOG_FORMAT</span><span class="o">=</span>text
<span class="nv">SSOSYNC_GOOGLE_CREDENTIALS</span><span class="o">=</span>credentials.json
<span class="nv">SSOSYNC_GOOGLE_ADMIN</span><span class="o">=</span>johndoe@domain.tld
<span class="nv">SSOSYNC_SCIM_ENDPOINT</span><span class="o">=</span><span class="sb">`</span><span class="nb">cat </span>SSOSYNC_SCIM_ENDPOINT.txt<span class="sb">`</span>
<span class="nv">SSOSYNC_SCIM_ACCESS_TOKEN</span><span class="o">=</span><span class="sb">`</span><span class="nb">cat </span>SSOSYNC_SCIM_ACCESS_TOKEN.txt<span class="sb">`</span>
<span class="nv">SSOSYNC_REGION</span><span class="o">=</span>us-east-1
<span class="nv">SSOSYNC_IDENTITY_STORE_ID</span><span class="o">=</span>d-xxxxxxxxxx
<span class="nv">SSOSYNC_USER_MATCH</span><span class="o">=</span>
<span class="nv">SSOSYNC_GROUP_MATCH</span><span class="o">=</span>
<span class="nv">SSOSYNC_SYNC_METHOD</span><span class="o">=</span><span class="nb">groups
</span><span class="nv">SSOSYNC_IGNORE_GROUPS</span><span class="o">=</span>
<span class="nv">SSOSYNC_IGNORE_USERS</span><span class="o">=</span>
<span class="nv">SSOSYNC_INCLUDE_GROUPS</span><span class="o">=</span>

<span class="nv">AWS_ACCESS_KEY_ID</span><span class="o">=</span>
<span class="nv">AWS_SECRET_ACCESS_KEY</span><span class="o">=</span>
</pre></td>
</tr></tbody></table></code></div>
</div>
<p>Load the environment variables on your shell session.</p>
<div class="language-bash nolineno highlighter-rouge" file="ssosync">
<div class="code-header"> <span data-label-text="ssosync"><i class="far fa-file-code fa-fw"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td>
<td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">set</span> <span class="nt">-a</span> <span class="o">&amp;&amp;</span> <span class="nb">source</span> .env <span class="o">&amp;&amp;</span> <span class="nb">set</span> +a

</pre></td>
</tr></tbody></table></code></div>
</div>
<p>Run the SSO Sync binary</p>
<div class="language-bash nolineno highlighter-rouge" file="ssosync standard output (stdout)">
<div class="code-header"> <span data-label-text="ssosync standard output (stdout)"><i class="far fa-file-code fa-fw"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td>
<td class="rouge-code"><pre><span class="nv">$ </span>./ssosync

<span class="c"># INFO[0000] Syncing AWS users and groups from Google Workspace SAML Application</span>
<span class="c"># INFO[0000] syncing                                       sync_method=groups</span>
<span class="c"># INFO[0000] get google groups                             query=</span>
<span class="c"># DEBU[0001] preparing list of google users and then google groups and their members</span>
<span class="c"># DEBU[0001] get group members from google                 group=administrator</span>
<span class="c"># DEBU[0001] get users                                     group=administrator</span>
<span class="c"># DEBU[0001] get user                                      group=administrator id=johndoe@domain.tld</span>
<span class="c"># INFO[0002] get existing aws groups</span>
<span class="c"># INFO[0003] get existing aws users</span>
<span class="c"># INFO[0003] get active status for aws users</span>
<span class="c"># INFO[0004] preparing map of user id's to user</span>
<span class="c"># DEBU[0004] preparing list of aws groups and their members</span>
<span class="c"># INFO[0004] syncing changes</span>
<span class="c"># DEBU[0004] deleting aws users deleted in google</span>
<span class="c"># DEBU[0004] updating aws users updated in google</span>
<span class="c"># DEBU[0004] creating aws users added in google</span>
<span class="c"># DEBU[0004] creating aws groups added in google</span>
<span class="c"># DEBU[0004] validating groups members, equals in aws and google</span>
<span class="c"># DEBU[0004] finding user                                  group=administrator user=johndoe@domain.tld</span>
<span class="c"># DEBU[0005] checking user is in group already             group=administrator user=johndoe@domain.tld</span>
<span class="c"># DEBU[0005] delete aws groups deleted in google</span>
<span class="c"># INFO[0005] sync completed</span>
</pre></td>
</tr></tbody></table></code></div>
</div>
<p><img class="emoji" title=":tada:" alt=":tada:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f389.png" height="20" width="20"> As you have seen, the SSO Sync STDOUT shows the expected results. Users and Groups from Google Workspace Directory sync perfectly to our AWS IAM Identity Center.</p>
<h3 id="periodically-sync-through-aws-sam-production">
<span class="me-2">Periodically Sync through AWS SAM <em>(Production)</em></span><a href="#periodically-sync-through-aws-sam-production" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h3>
<h4 id="build-the-sam-to-deployable-template">
<span class="me-2">Build the SAM to deployable template</span><a href="#build-the-sam-to-deployable-template" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<div class="language-bash nolineno highlighter-rouge" file="sam build">
<div class="code-header"> <span data-label-text="sam build"><i class="far fa-file-code fa-fw"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td>
<td class="rouge-code"><pre><span class="nv">$ </span>sam build

<span class="c"># Building codeuri: /path/to/awslabs/ssosync runtime: go1.x metadata: {} architecture: x86_64 functions: SSOSyncFunction</span>
<span class="c"># Running GoModulesBuilder:Build</span>

<span class="c"># Build Succeeded</span>

<span class="c"># Built Artifacts  : .aws-sam/build</span>
<span class="c"># Built Template   : .aws-sam/build/template.yaml</span>

<span class="c"># Commands you can use next</span>
<span class="c"># =========================</span>
<span class="c"># [*] Validate SAM template: sam validate</span>
<span class="c"># [*] Invoke Function: sam local invoke</span>
<span class="c"># [*] Test Function in the Cloud: sam sync --stack-name  --watch</span>
<span class="c"># [*] Deploy: sam deploy --guided</span>
</pre></td>
</tr></tbody></table></code></div>
</div>
<h4 id="deploy-the-sso-sync-sam-application">
<span class="me-2">Deploy the SSO Sync SAM Application</span><a href="#deploy-the-sso-sync-sam-application" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<div class="language-bash nolineno highlighter-rouge" file="sam deploy --guided">
<div class="code-header"> <span data-label-text="sam deploy --guided"><i class="far fa-file-code fa-fw"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
</pre></td>
<td class="rouge-code"><pre><span class="nv">$ </span>sam deploy <span class="nt">--guided</span>

<span class="c"># Configuring SAM deploy</span>
<span class="c"># ======================</span>

<span class="c">#   Looking for config file [samconfig.toml] :  Not found</span>

<span class="c">#   Setting default arguments for 'sam deploy'</span>
<span class="c">#   =========================================</span>
<span class="c">#   Stack Name [sam-app]: SSOSync</span>
<span class="c">#   AWS Region [us-east-1]:</span>
<span class="c">#   Parameter ScheduleExpression [rate(15 minutes)]:</span>
<span class="c">#   Parameter LogLevel [warn]:</span>
<span class="c">#   Parameter LogFormat [json]:</span>
<span class="c">#   Parameter GoogleCredentials:</span>
<span class="c">#   Parameter GoogleAdminEmail:</span>
<span class="c">#   Parameter SCIMEndpointUrl:</span>
<span class="c">#   Parameter SCIMEndpointAccessToken:</span>
<span class="c">#   Parameter Region:</span>
<span class="c">#   Parameter IdentityStoreID:</span>
<span class="c">#   Parameter GoogleUserMatch []:</span>
<span class="c">#   Parameter GoogleGroupMatch []:</span>
<span class="c">#   Parameter IgnoreGroups []:</span>
<span class="c">#   Parameter IgnoreUsers []:</span>
<span class="c">#   Parameter IncludeGroups []:</span>
<span class="c">#   Parameter SyncMethod [groups]:</span>
<span class="c">#   #Shows you resources changes to be deployed and require a 'Y' to initiate deploy</span>
<span class="c">#   Confirm changes before deploy [y/N]:</span>
<span class="c">#   #SAM needs permission to be able to create roles to connect to the resources in your template</span>
<span class="c">#   Allow SAM CLI IAM role creation [Y/n]:</span>
<span class="c">#   #Preserves the state of previously provisioned resources when an operation fails</span>
<span class="c">#   Disable rollback [y/N]:</span>
<span class="c">#   Save arguments to configuration file [Y/n]:</span>
<span class="c">#   SAM configuration file [samconfig.toml]:</span>
<span class="c">#   SAM configuration environment [default]:</span>

<span class="c">#   **** TRUNCATED DETAILS ****</span>

<span class="c">#   Deploying with following values</span>
<span class="c">#   ===============================</span>
<span class="c">#   Stack name                   : SSOSync</span>
<span class="c">#   Region                       : us-east-1</span>
<span class="c">#   Confirm changeset            : False</span>
<span class="c">#   Disable rollback             : False</span>
<span class="c">#   Deployment s3 bucket         : aws-sam-cli-managed-default-samclisourcebucket-*************</span>
<span class="c">#   Capabilities                 : ["CAPABILITY_IAM"]</span>
<span class="c">#   Parameter overrides          : {"ScheduleExpression": "rate(15 minutes)", "LogLevel": "warn", "LogFormat": "json", "GoogleCredentials": "*****", "GoogleAdminEmail": "*****", "SCIMEndpointUrl": "*****", "SCIMEndpointAccessToken": "*****", "Region": "*****", "IdentityStoreID": "*****", "GoogleUserMatch": "", "GoogleGroupMatch": "", "IgnoreGroups": "", "IgnoreUsers": "", "IncludeGroups": "", "SyncMethod": "groups"}</span>
<span class="c">#   Signing Profiles             : {}</span>

<span class="c"># Initiating deployment</span>
<span class="c"># =====================</span>
<span class="c"># File with same data already exists at SSOSync/*************.template, skipping upload</span>

<span class="c"># Waiting for changeset to be created..</span>
<span class="c"># CloudFormation stack changeset</span>
<span class="c"># -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="c"># Operation                                         LogicalResourceId                                 ResourceType                                      Replacement</span>
<span class="c"># -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="c"># + Add                                             AWSGoogleAdminEmail                               AWS::SecretsManager::Secret                       N/A</span>
<span class="c"># + Add                                             AWSGoogleCredentialsSecret                        AWS::SecretsManager::Secret                       N/A</span>
<span class="c"># + Add                                             AWSIdentityStoreIDSecret                          AWS::SecretsManager::Secret                       N/A</span>
<span class="c"># + Add                                             AWSRegionSecret                                   AWS::SecretsManager::Secret                       N/A</span>
<span class="c"># + Add                                             AWSSCIMAccessTokenSecret                          AWS::SecretsManager::Secret                       N/A</span>
<span class="c"># + Add                                             AWSSCIMEndpointSecret                             AWS::SecretsManager::Secret                       N/A</span>
<span class="c"># + Add                                             SSOSyncFunctionRole                               AWS::IAM::Role                                    N/A</span>
<span class="c"># + Add                                             SSOSyncFunctionSyncScheduledEventPermission       AWS::Lambda::Permission                           N/A</span>
<span class="c"># + Add                                             SSOSyncFunctionSyncScheduledEvent                 AWS::Events::Rule                                 N/A</span>
<span class="c"># + Add                                             SSOSyncFunction                                   AWS::Lambda::Function                             N/A</span>
<span class="c"># -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>

<span class="c"># Changeset created successfully. arn:aws:cloudformation:us-east-1:*************:changeSet/samcli-deploy*************/*************</span>


<span class="c"># 2023-02-13 00:52:57 - Waiting for stack create/update to complete</span>

<span class="c"># CloudFormation events from stack operations (refresh every 0.5 seconds)</span>
<span class="c"># -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="c"># ResourceStatus                                    ResourceType                                      LogicalResourceId                                 ResourceStatusReason</span>
<span class="c"># -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span class="c"># CREATE_IN_PROGRESS                                AWS::SecretsManager::Secret                       AWSSCIMEndpointSecret                             -</span>
<span class="c"># CREATE_IN_PROGRESS                                AWS::SecretsManager::Secret                       AWSSCIMAccessTokenSecret                          -</span>
<span class="c"># CREATE_IN_PROGRESS                                AWS::SecretsManager::Secret                       AWSGoogleCredentialsSecret                        -</span>
<span class="c"># CREATE_IN_PROGRESS                                AWS::SecretsManager::Secret                       AWSRegionSecret                                   -</span>
<span class="c"># CREATE_IN_PROGRESS                                AWS::SecretsManager::Secret                       AWSIdentityStoreIDSecret                          -</span>
<span class="c"># CREATE_IN_PROGRESS                                AWS::SecretsManager::Secret                       AWSSCIMEndpointSecret                             Resource creation Initiated</span>
<span class="c"># CREATE_IN_PROGRESS                                AWS::SecretsManager::Secret                       AWSRegionSecret                                   Resource creation Initiated</span>
<span class="c"># CREATE_IN_PROGRESS                                AWS::SecretsManager::Secret                       AWSSCIMAccessTokenSecret                          Resource creation Initiated</span>
<span class="c"># CREATE_COMPLETE                                   AWS::SecretsManager::Secret                       AWSSCIMEndpointSecret                             -</span>
<span class="c"># CREATE_IN_PROGRESS                                AWS::SecretsManager::Secret                       AWSIdentityStoreIDSecret                          Resource creation Initiated</span>
<span class="c"># CREATE_COMPLETE                                   AWS::SecretsManager::Secret                       AWSSCIMAccessTokenSecret                          -</span>
<span class="c"># CREATE_IN_PROGRESS                                AWS::SecretsManager::Secret                       AWSGoogleAdminEmail                               Resource creation Initiated</span>
<span class="c"># CREATE_COMPLETE                                   AWS::SecretsManager::Secret                       AWSRegionSecret                                   -</span>
<span class="c"># CREATE_COMPLETE                                   AWS::SecretsManager::Secret                       AWSIdentityStoreIDSecret                          -</span>
<span class="c"># CREATE_COMPLETE                                   AWS::SecretsManager::Secret                       AWSGoogleCredentialsSecret                        -</span>
<span class="c"># CREATE_COMPLETE                                   AWS::SecretsManager::Secret                       AWSGoogleAdminEmail                               -</span>
<span class="c"># CREATE_IN_PROGRESS                                AWS::IAM::Role                                    SSOSyncFunctionRole                               -</span>
<span class="c"># CREATE_IN_PROGRESS                                AWS::IAM::Role                                    SSOSyncFunctionRole                               Resource creation Initiated</span>
<span class="c"># CREATE_COMPLETE                                   AWS::IAM::Role                                    SSOSyncFunctionRole                               -</span>
<span class="c"># CREATE_IN_PROGRESS                                AWS::Lambda::Function                             SSOSyncFunction                                   -</span>
<span class="c"># CREATE_IN_PROGRESS                                AWS::Lambda::Function                             SSOSyncFunction                                   Resource creation Initiated</span>
<span class="c"># CREATE_COMPLETE                                   AWS::Lambda::Function                             SSOSyncFunction                                   -</span>
<span class="c"># CREATE_IN_PROGRESS                                AWS::Events::Rule                                 SSOSyncFunctionSyncScheduledEvent                 -</span>
<span class="c"># CREATE_IN_PROGRESS                                AWS::Events::Rule                                 SSOSyncFunctionSyncScheduledEvent                 Resource creation Initiated</span>
<span class="c"># CREATE_COMPLETE                                   AWS::Events::Rule                                 SSOSyncFunctionSyncScheduledEvent                 -</span>
<span class="c"># CREATE_IN_PROGRESS                                AWS::Lambda::Permission                           SSOSyncFunctionSyncScheduledEventPermission       -</span>
<span class="c"># CREATE_IN_PROGRESS                                AWS::Lambda::Permission                           SSOSyncFunctionSyncScheduledEventPermission       Resource creation Initiated</span>
<span class="c"># CREATE_COMPLETE                                   AWS::Lambda::Permission                           SSOSyncFunctionSyncScheduledEventPermission       -</span>
<span class="c"># CREATE_COMPLETE                                   AWS::CloudFormation::Stack                        SSOSync                                           -</span>
<span class="c"># -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>

<span class="c"># Successfully created/updated stack - SSOSync in us-east-1</span>
</pre></td>
</tr></tbody></table></code></div>
</div>
<h4 id="test-the-ssosync-lambda-application-lambda-function-stack">
<span class="me-2">Test the <code class="language-plaintext highlighter-rouge">SSOSync</code> Lambda Application <em>(Lambda Function Stack)</em></span><a href="#test-the-ssosync-lambda-application-lambda-function-stack" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<p>Testing locally if deployed parameters are properly configured.</p>
<div class="language-bash nolineno highlighter-rouge" file="Emulated Local Runtime">
<div class="code-header"> <span data-label-text="Emulated Local Runtime"><i class="far fa-file-code fa-fw"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre></td>
<td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'{}'</span> | sam <span class="nb">local </span>invoke <span class="nt">--event</span> - <span class="s2">"SSOSyncFunction"</span>

<span class="c"># Reading invoke payload from stdin (you can also pass it from file with --event)</span>
<span class="c"># Invoking dist/ssosync_linux_amd64_v1/ssosync (go1.x)</span>
<span class="c"># Local image was not found.</span>
<span class="c"># Removing rapid images for repo public.ecr.aws/sam/emulation-go1.x</span>
<span class="c"># Building image.............................................................</span>
<span class="c"># Using local image: public.ecr.aws/lambda/go:1-rapid-x86_64.</span>

<span class="c"># Mounting /path/to/awslabs/ssosync/.aws-sam/build/SSOSyncFunction as /var/task:ro,delegated inside runtime container</span>
<span class="c"># START RequestId: **************************** Version: $LATEST</span>
<span class="c"># time="2023-02-12T17:39:35Z" level=info msg="Executing as Lambda"</span>
<span class="c"># time="2023-02-12T17:39:38Z" level=info msg="Syncing AWS users and groups from Google Workspace SAML Application"</span>
<span class="c"># time="2023-02-12T17:39:38Z" level=info msg=syncing sync_method=groups</span>
<span class="c"># time="2023-02-12T17:39:38Z" level=info msg="get google groups" query=</span>
<span class="c"># time="2023-02-12T17:39:39Z" level=debug msg="preparing list of google users and then google groups and their members"</span>
<span class="c"># time="2023-02-12T17:39:39Z" level=debug msg="get group members from google" group=administrator</span>
<span class="c"># time="2023-02-12T17:39:39Z" level=debug msg="get users" group=administrator</span>
<span class="c"># time="2023-02-12T17:39:39Z" level=debug msg="get user" group=administrator id=johndoe@domain.tld</span>
<span class="c"># time="2023-02-12T17:39:40Z" level=info msg="get existing aws groups"</span>
<span class="c"># time="2023-02-12T17:39:41Z" level=info msg="get existing aws users"</span>
<span class="c"># time="2023-02-12T17:39:42Z" level=info msg="get active status for aws users"</span>
<span class="c"># time="2023-02-12T17:39:43Z" level=info msg="preparing map of user id's to user"</span>
<span class="c"># time="2023-02-12T17:39:43Z" level=debug msg="preparing list of aws groups and their members"</span>
<span class="c"># time="2023-02-12T17:39:43Z" level=info msg="syncing changes"</span>
<span class="c"># time="2023-02-12T17:39:43Z" level=debug msg="deleting aws users deleted in google"</span>
<span class="c"># time="2023-02-12T17:39:43Z" level=debug msg="updating aws users updated in google"</span>
<span class="c"># time="2023-02-12T17:39:43Z" level=debug msg="creating aws users added in google"</span>
<span class="c"># time="2023-02-12T17:39:43Z" level=debug msg="creating aws groups added in google"</span>
<span class="c"># time="2023-02-12T17:39:43Z" level=debug msg="validating groups members, equals in aws and google"</span>
<span class="c"># time="2023-02-12T17:39:43Z" level=debug msg="finding user" group=administrator user=johndoe@domain.tld</span>
<span class="c"># time="2023-02-12T17:39:44Z" level=debug msg="checking user is in group already" group=administrator user=johndoe@domain.tld</span>
<span class="c"># time="2023-02-12T17:39:44Z" level=debug msg="delete aws groups deleted in google"</span>
<span class="c"># time="2023-02-12T17:39:44Z" level=info msg="sync completed"</span>
<span class="c"># "Success"END RequestId: ****************************</span>
<span class="c"># REPORT RequestId: ****************************	Init Duration: 0.16 ms	Duration: 8748.82 ms	Billed Duration: 8749 ms	Memory Size: 128 MB	Max Memory Used: 128 MB</span>
</pre></td>
</tr></tbody></table></code></div>
</div>
<p>Test the production deployed Lambda Application and check the rest of the events in the AWS Cloudwatch log groups application streams.</p>
<div class="language-bash nolineno highlighter-rouge" file="Cloud Execution">
<div class="code-header"> <span data-label-text="Cloud Execution"><i class="far fa-file-code fa-fw"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td>
<td class="rouge-code"><pre><span class="nv">$ </span>aws lambda invoke <span class="nt">--function-name</span> SSOSync-SSOSyncFunction-<span class="k">************</span> <span class="nt">--payload</span> <span class="s1">'{}'</span> response.json

<span class="c"># {</span>
<span class="c">#     "StatusCode": 200,</span>
<span class="c">#     "ExecutedVersion": "$LATEST"</span>
<span class="c"># }</span>

<span class="c"># $ cat response.json</span>
<span class="c"># "Success"</span>
</pre></td>
</tr></tbody></table></code></div>
</div>
<p><img class="emoji" title=":tada:" alt=":tada:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f389.png" height="20" width="20"> Let the <code class="language-plaintext highlighter-rouge">Lambda Application</code> and its <code class="language-plaintext highlighter-rouge">EventBridge</code> periodic settings execute the syncing from the Google Workspace Directory to AWS IAM Identity Center do the rest.</p>
<h4 id="other-deployment-options">
<span class="me-2">Other Deployment Options</span><a href="#other-deployment-options" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h4>
<blockquote class="prompt-tip"><p>You can also deploy the SSO Sync Lambda Application through AWS Console using the <a href="https://eu-west-1.console.aws.amazon.com/lambda/home#/create/app?applicationId=arn:aws:serverlessrepo:us-east-2:004480582608:applications/SSOSync">AWS Serverless Application Repository</a>. Just fill in the required parameters and deploy. Then Wait for the AWS Cloudformation to automate the deployment process.</p></blockquote>
</div>
<div class="post-tail-wrapper text-muted">
<div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/aws/">AWS</a>, <a href="/categories/iam-identity-center/">IAM Identity Center</a>
</div>
<div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/google-workspace-gsuite/" class="post-tag no-text-decoration">Google Workspace (GSuite)</a> <a href="/tags/google-cloud-platform-gcp/" class="post-tag no-text-decoration">Google Cloud Platform (GCP)</a> <a href="/tags/amazon-web-services-aws/" class="post-tag no-text-decoration">Amazon Web Services (AWS)</a> <a href="/tags/single-sign-on-sso/" class="post-tag no-text-decoration">Single Sign-On (SSO)</a> <a href="/tags/aws-iam-identity-center/" class="post-tag no-text-decoration">AWS IAM Identity Center</a> <a href="/tags/aws-labs/" class="post-tag no-text-decoration">AWS Labs</a> <a href="/tags/sso-sync/" class="post-tag no-text-decoration">SSO Sync</a> <a href="/tags/aws-cloudformation/" class="post-tag no-text-decoration">AWS Cloudformation</a> <a href="/tags/aws-sam/" class="post-tag no-text-decoration">AWS SAM</a> <a href="/tags/lambda/" class="post-tag no-text-decoration">Lambda</a> <a href="/tags/serverless/" class="post-tag no-text-decoration">Serverless</a>
</div>
<div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 ">
<div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div>
<div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Automatic%20Provisioning%20of%20AWS%20IAM%20Identity%20Center%20Users%20and%20Groups%20from%20Google%20Workspace%20Directory%20using%20SSO%20Sync%20-%20Nathaniel%20Varona&amp;url=https%3A%2F%2Fnathaniel.varona.me%2Fposts%2Fautomatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Automatic%20Provisioning%20of%20AWS%20IAM%20Identity%20Center%20Users%20and%20Groups%20from%20Google%20Workspace%20Directory%20using%20SSO%20Sync%20-%20Nathaniel%20Varona&amp;u=https%3A%2F%2Fnathaniel.varona.me%2Fposts%2Fautomatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/feed/?shareActive=true&amp;shareUrl=https%3A%2F%2Fnathaniel.varona.me%2Fposts%2Fautomatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span>
</div>
</div>
</div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access">
<section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2>
<ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
<li class="text-truncate lh-lg"> <a href="/posts/google-workspace-as-external-idp-for-aws-iam-identity-center/">Google Workspace as an external IdP for AWS IAM Identity Center</a>
</li>
<li class="text-truncate lh-lg"> <a href="/posts/automatic-provisioning-of-aws-iam-identity-center-users-and-groups-from-google-workspace-directory-using-sso-sync/">Automatic Provisioning of AWS IAM Identity Center Users and Groups from Google Workspace Directory using SSO Sync</a>
</li>
<li class="text-truncate lh-lg"> <a href="/posts/managing-aws-iam-identity-center-multi-account-permissions-using-terraform-and-github-actions/">Managing AWS IAM Identity Center Multi-Account Permissions using Terraform and GitHub Actions</a>
</li>
<li class="text-truncate lh-lg"> <a href="/posts/managing-enterprise-vpn-using-pritunl-api-cli/">Managing Enterprise VPN using Pritunl API CLI</a>
</li>
<li class="text-truncate lh-lg"> <a href="/posts/build-a-pritunl-slack-slash-commands-with-a-serverless-backend/">Build a Pritunl Slack Slash Commands with a Serverless Backend</a>
</li>
</ul></section><section><h2 class="panel-heading">Trending Tags</h2>
<div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/amazon-web-services-aws/">Amazon Web Services (AWS)</a> <a class="post-tag btn btn-outline-primary" href="/tags/aws-iam-identity-center/">AWS IAM Identity Center</a> <a class="post-tag btn btn-outline-primary" href="/tags/single-sign-on-sso/">Single Sign-On (SSO)</a> <a class="post-tag btn btn-outline-primary" href="/tags/api-client/">API Client</a> <a class="post-tag btn btn-outline-primary" href="/tags/aws-sam/">AWS SAM</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-cloud-platform-gcp/">Google Cloud Platform (GCP)</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-workspace-gsuite/">Google Workspace (GSuite)</a> <a class="post-tag btn btn-outline-primary" href="/tags/openvpn/">OpenVPN</a> <a class="post-tag btn btn-outline-primary" href="/tags/pritunl-vpn/">Pritunl VPN</a> <a class="post-tag btn btn-outline-primary" href="/tags/python-library/">Python Library</a>
</div></section>
</div>
<div class="toc-border-cover z-3"></div>
<section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
<nav id="toc"></nav></section></aside>
</div>
<div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
<aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3>
<nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/google-workspace-as-external-idp-for-aws-iam-identity-center/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1674748800" data-df="ll"> Jan 27, 2023 </time><h4 class="pt-0 my-2">Google Workspace as an external IdP for AWS IAM Identity Center</h4>
<div class="text-muted"><p>Introduction Google Workspace (formerly known as GSuite) is a typical first service for companies embracing the cloud, especially startups. Google Workspace provides out-of-the-box services like e...</p></div>
</div></a></article><article class="col"> <a href="/posts/managing-aws-iam-identity-center-multi-account-permissions-using-terraform-and-github-actions/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1677772800" data-df="ll"> Mar 3, 2023 </time><h4 class="pt-0 my-2">Managing AWS IAM Identity Center Multi-Account Permissions using Terraform and GitHub Actions</h4>
<div class="text-muted"><p>Introduction Maintaining accounts with Terraform ensures a single source of truth about what changes we made for our principals and recommended policies based on organization guidelines. We can al...</p></div>
</div></a></article><article class="col"> <a href="/posts/build-a-pritunl-slack-slash-commands-with-a-serverless-backend/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1682611200" data-df="ll"> Apr 28, 2023 </time><h4 class="pt-0 my-2">Build a Pritunl Slack Slash Commands with a Serverless Backend</h4>
<div class="text-muted"><p>Introduction For self-service automation, Slack is one of the leading platforms that it can provide. As DevOps, which also considers company administrators, we ensure team members, such as Develop...</p></div>
</div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/google-workspace-as-external-idp-for-aws-iam-identity-center/" class="btn btn-outline-primary" aria-label="Older"><p>Google Workspace as an external IdP for AWS IAM Identity Center</p></a> <a href="/posts/managing-aws-iam-identity-center-multi-account-permissions-using-terraform-and-github-actions/" class="btn btn-outline-primary" aria-label="Newer"><p>Managing AWS IAM Identity Center Multi-Account Permissions using Terraform and GitHub Actions</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 "><p>Â© <time>2025</time> <a href="https://twitter.com/nathanielvarona">Nathaniel Varona</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p>
<p>Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.4.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>.</p></footer>
</div></div>
<div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content">
<div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2>
<div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/amazon-web-services-aws/">Amazon Web Services (AWS)</a> <a class="post-tag btn btn-outline-primary" href="/tags/aws-iam-identity-center/">AWS IAM Identity Center</a> <a class="post-tag btn btn-outline-primary" href="/tags/single-sign-on-sso/">Single Sign-On (SSO)</a> <a class="post-tag btn btn-outline-primary" href="/tags/api-client/">API Client</a> <a class="post-tag btn btn-outline-primary" href="/tags/aws-sam/">AWS SAM</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-cloud-platform-gcp/">Google Cloud Platform (GCP)</a> <a class="post-tag btn btn-outline-primary" href="/tags/google-workspace-gsuite/">Google Workspace (GSuite)</a> <a class="post-tag btn btn-outline-primary" href="/tags/openvpn/">OpenVPN</a> <a class="post-tag btn btn-outline-primary" href="/tags/pritunl-vpn/">Pritunl VPN</a> <a class="post-tag btn btn-outline-primary" href="/tags/python-library/">Python Library</a>
</div></section></div>
<div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
</div></div>
</div>
<aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside>
</div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false"><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close"></button>
</div>
<div class="toast-body text-center pt-0">
<p class="px-2 mb-3">A new version of content is available.</p>
<button type="button" class="btn btn-primary" aria-label="Update"> Update </button>
</div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'en';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'nathanielvarona/nathanielvarona.github.io', 'data-repo-id': 'R_kgDOI9wegw', 'data-category': 'Comments', 'data-category-id': 'DIC_kwDOI9weg84CUvHZ', 'data-mapping': 'pathname', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{content}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
